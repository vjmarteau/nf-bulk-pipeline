Bootstrap: docker
From: mambaorg/micromamba

%setup
    mkdir -p ${SINGULARITY_ROOTFS}/opt/Rscripts
    mkdir -p ${SINGULARITY_ROOTFS}/input_data
    mkdir -p ${SINGULARITY_ROOTFS}/results
    

%files
    R-modules.yaml /R-modules.yaml
    Reformat_pseudobulk.R /opt/Rscripts/Reformat_pseudobulk.R

%post
 apt-get update

    export LANG=C.UTF-8 LC_ALL=C.UTF-8
    export PATH=/opt/conda/bin:$PATH

    micromamba install --yes --name base --file /R-modules.yaml

    rm -f /R-modules.yml

    apt-get clean
    micromamba clean --all --yes

%environment
    export LANG=C.UTF-8 LC_ALL=C.UTF-8
    export PATH=/opt/conda/bin:$PATH

%labels
    Author vjmarteau
    Version v0.0.1